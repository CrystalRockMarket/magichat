<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Hat Link | Rainbow Family</title>
    <meta name="description" content="Support the Rainbow Family Magic Hat with every Amazon purchase ‚Äî at no extra cost to you. Convert any Amazon link and 1-3% goes directly to feeding the family.">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Magic Hat Link | Rainbow Family">
    <meta property="og:description" content="Support the Rainbow Family Magic Hat with every Amazon purchase ‚Äî at no extra cost to you. Amazon gives back 1-3% on every sale.">
    <meta property="og:image" content="https://magichat.one/og-image.png">
    <meta property="og:url" content="https://magichat.one/">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Magic Hat Link | Rainbow Family">
    <meta name="twitter:description" content="Support the Rainbow Family Magic Hat with every Amazon purchase ‚Äî at no extra cost to you.">
    <meta name="twitter:image" content="https://magichat.one/og-image.png">
    
    <!-- Favicon (hat emoji as SVG data URI) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé©</text></svg>">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #1a1625;
            --bg-card: #241f31;
            --bg-input: #2d2640;
            --bg-hover: #322a45;
            --border: #3d3555;
            --border-hover: #4d4565;
            --text-primary: #f5f0ff;
            --text-secondary: #b8a9d4;
            --text-muted: #7a6a99;
            
            /* Rainbow spectrum */
            --red: #ff6b6b;
            --orange: #ffa94d;
            --yellow: #ffd43b;
            --green: #69db7c;
            --blue: #74c0fc;
            --indigo: #9775fa;
            --violet: #da77f2;
            
            --accent: var(--yellow);
            --success: var(--green);
            --error: var(--red);
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
        }

        html, body {
            min-height: 100%;
        }

        body {
            font-family: 'Quicksand', -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            background-image:
                radial-gradient(ellipse 100% 60% at 20% 0%, rgba(218, 119, 242, 0.12), transparent),
                radial-gradient(ellipse 80% 50% at 80% 10%, rgba(116, 192, 252, 0.1), transparent),
                radial-gradient(ellipse 60% 40% at 50% 100%, rgba(255, 212, 59, 0.08), transparent);
            background-attachment: fixed;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 680px;
            margin: 0 auto;
            padding: var(--space-md);
            transform-origin: top center;
        }

        @media (min-width: 1400px) {
            .app-container {
                transform: scale(1.15);
                max-width: 780px;
            }
        }

        @media (min-width: 1800px) {
            .app-container {
                transform: scale(1.3);
                max-width: 880px;
            }
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
            margin-bottom: var(--space-sm);
            flex-shrink: 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            font-size: 32px;
            filter: drop-shadow(0 2px 8px rgba(255, 212, 59, 0.4));
        }

        .logo h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.5px;
            color: var(--text-primary);
        }

        .total-earned-badge {
            background: rgba(105, 219, 124, 0.1);
            border: 1px solid var(--green);
            border-radius: 20px;
            padding: 6px 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            color: var(--green);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .total-earned-badge .label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        @media (max-width: 500px) {
            .total-earned-badge .label {
                display: none;
            }
        }

        /* Rainbow bar */
        .rainbow-bar {
            height: 3px;
            background: linear-gradient(90deg, 
                var(--red), var(--orange), var(--yellow), 
                var(--green), var(--blue), var(--indigo), var(--violet));
            border-radius: 2px;
            margin-bottom: var(--space-md);
            flex-shrink: 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        /* Converter Section */
        .converter-section {
            flex-shrink: 0;
            margin-bottom: var(--space-md);
        }

        .tagline {
            text-align: center;
            color: var(--text-secondary);
            font-size: 15px;
            font-weight: 500;
            margin-bottom: var(--space-md);
        }

        .input-wrapper {
            position: relative;
            margin-bottom: var(--space-sm);
        }

        .input-field {
            width: 100%;
            height: 52px;
            padding: 0 18px;
            font-size: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-input);
            color: var(--text-primary);
            font-family: 'Quicksand', sans-serif;
            transition: all 0.2s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(255, 212, 59, 0.15);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .convert-btn {
            width: 100%;
            height: 48px;
            background: linear-gradient(135deg, var(--yellow) 0%, var(--orange) 100%);
            border: none;
            border-radius: 12px;
            font-family: 'Quicksand', sans-serif;
            font-size: 15px;
            font-weight: 700;
            color: #1a1625;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 16px rgba(255, 212, 59, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .convert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(255, 212, 59, 0.4);
        }

        .convert-btn:active {
            transform: translateY(0);
        }

        /* Output Area */
        .output-area {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin 0.3s ease;
            opacity: 0;
        }

        .output-area.visible {
            max-height: 500px;
            opacity: 1;
            margin-top: var(--space-md);
        }

        .output-box {
            background: var(--bg-input);
            border: 2px solid var(--success);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
        }

        .output-type {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .output-type.clean {
            background: rgba(105, 219, 124, 0.15);
            color: var(--success);
        }

        .output-type.fallback {
            background: rgba(255, 169, 77, 0.15);
            color: var(--orange);
        }

        .output-type.search {
            background: rgba(116, 192, 252, 0.15);
            color: var(--blue);
        }

        .output-type .status-dot {
            width: 6px;
            height: 6px;
            background: currentColor;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .output-url {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--success);
            word-break: break-all;
            line-height: 1.5;
        }

        .output-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 16px;
            font-family: 'Quicksand', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-hover);
        }

        .action-btn.copied {
            background: rgba(105, 219, 124, 0.15);
            border-color: var(--success);
            color: var(--success);
        }

        .action-btn svg {
            width: 16px;
            height: 16px;
        }

        /* Error Message */
        .error-message {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin 0.3s ease;
            opacity: 0;
        }

        .error-message.visible {
            max-height: 100px;
            opacity: 1;
            margin-top: var(--space-sm);
        }

        .error-box {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 10px;
            padding: 12px 14px;
            font-size: 13px;
            font-weight: 500;
            color: var(--error);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-4px); }
            75% { transform: translateX(4px); }
        }

        .error-message.visible .error-box {
            animation: shake 0.4s ease;
        }

        /* Tab Section */
        .tab-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        .tab-bar {
            display: flex;
            justify-content: center;
            gap: 4px;
            padding: 4px;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border);
            flex-shrink: 0;
            margin-bottom: var(--space-sm);
        }

        .tab-btn {
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-muted);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text-secondary);
        }

        .tab-btn.active {
            background: var(--bg-input);
            color: var(--accent);
        }

        @media (max-width: 500px) {
            .tab-btn {
                padding: 8px 10px;
                font-size: 12px;
            }
            .tab-btn .tab-text {
                display: none;
            }
        }

        /* Tab Panels */
        .tab-panels {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        .tab-panels::-webkit-scrollbar {
            width: 6px;
        }

        .tab-panels::-webkit-scrollbar-track {
            background: transparent;
        }

        .tab-panels::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .tab-panel {
            display: none;
            animation: fadeIn 0.2s ease;
        }

        .tab-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: var(--space-md);
        }

        /* How It Works Panel */
        .how-it-works p {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }

        .distribution-bar {
            display: flex;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: var(--space-sm);
        }

        .distribution-segment {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            color: var(--bg-dark);
        }

        .distribution-segment.magic-hat {
            flex: 0 0 80%;
            background: linear-gradient(135deg, var(--yellow) 0%, var(--orange) 100%);
        }

        .distribution-segment.dao {
            flex: 0 0 15%;
            background: linear-gradient(135deg, var(--green) 0%, var(--blue) 100%);
        }

        .distribution-segment.server {
            flex: 0 0 5%;
            background: linear-gradient(135deg, var(--indigo) 0%, var(--violet) 100%);
        }

        .distribution-legend {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 2px;
        }

        .legend-dot.magic-hat { background: var(--yellow); }
        .legend-dot.dao { background: var(--green); }
        .legend-dot.server { background: var(--indigo); }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dashed var(--text-muted);
        }

        .tooltip::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px 14px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            line-height: 1.5;
            white-space: normal;
            width: 280px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-2px);
            border: 6px solid transparent;
            border-top-color: var(--border);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
            z-index: 100;
        }

        .tooltip:hover::before,
        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-4px);
        }

        .tooltip:hover::after {
            transform: translateX(-50%) translateY(2px);
        }

        /* Tooltip bottom variant for top-positioned elements */
        .tooltip-bottom {
            position: relative;
            cursor: help;
        }

        .tooltip-bottom::before {
            content: attr(data-tooltip);
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(8px);
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px 14px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            line-height: 1.5;
            white-space: normal;
            width: 250px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .tooltip-bottom::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(2px);
            border: 6px solid transparent;
            border-bottom-color: var(--border);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
            z-index: 1000;
        }

        .tooltip-bottom:hover::before,
        .tooltip-bottom:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(4px);
        }

        .tooltip-bottom:hover::after {
            transform: translateX(-50%) translateY(2px);
        }

        /* FAQ Panel */
        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .faq-item {
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            background: var(--bg-input);
        }

        .faq-question {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 14px 16px;
            background: transparent;
            border: none;
            cursor: pointer;
            text-align: left;
            font-family: 'Quicksand', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .faq-question:hover {
            color: var(--accent);
        }

        .faq-question svg {
            width: 18px;
            height: 18px;
            color: var(--text-muted);
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .faq-item.active .faq-question svg {
            transform: rotate(180deg);
            color: var(--accent);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .faq-item.active .faq-answer {
            max-height: 200px;
        }

        .faq-answer p {
            padding: 0 16px 14px 16px;
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin: 0;
        }

        /* Share Panel */
        .share-panel p {
            text-align: center;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }

        .share-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            border-radius: 10px;
            font-family: 'Quicksand', sans-serif;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .share-btn svg {
            width: 16px;
            height: 16px;
        }

        .share-btn.facebook {
            background: #1877f2;
            color: white;
        }

        .share-btn.facebook:hover {
            background: #0d65d9;
        }

        .share-btn.twitter {
            background: #000;
            color: white;
        }

        .share-btn.twitter:hover {
            background: #333;
        }

        .share-btn.reddit {
            background: #ff4500;
            color: white;
        }

        .share-btn.reddit:hover {
            background: #e03d00;
        }

        .share-btn.email {
            background: var(--indigo);
            color: white;
        }

        .share-btn.email:hover {
            background: #8363e8;
        }

        .share-btn.copy {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .share-btn.copy:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .share-btn.copy.copied {
            background: rgba(105, 219, 124, 0.15);
            border-color: var(--success);
            color: var(--success);
        }

        @media (max-width: 500px) {
            .share-btn .btn-text {
                display: none;
            }
            .share-btn {
                padding: 10px;
            }
        }

        /* Bookmark Panel */
        .bookmark-panel {
            text-align: center;
        }

        .bookmark-icon-large {
            font-size: 48px;
            margin-bottom: var(--space-sm);
        }

        .bookmark-panel h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .bookmark-panel p {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }

        .keyboard-shortcuts {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .shortcut {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .shortcut-key {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
        }

        .shortcut-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: var(--space-sm) 0 0;
            margin-top: auto;
            flex-shrink: 0;
        }

        .footer-text {
            font-size: 11px;
            color: var(--text-muted);
            line-height: 1.5;
            margin-bottom: var(--space-sm);
        }

        .rainbow-bar-bottom {
            height: 3px;
            background: linear-gradient(90deg, 
                var(--violet), var(--indigo), var(--blue), 
                var(--green), var(--yellow), var(--orange), var(--red));
            border-radius: 2px;
        }

        /* Success Flash Animation */
        .success-flash {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 64px;
            opacity: 0;
            pointer-events: none;
            z-index: 10000;
        }

        .success-flash.animate {
            animation: successPop 0.6s ease-out forwards;
        }

        @keyframes successPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        /* Confetti */
        .confetti-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        .confetti-container.active {
            display: block;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }

        /* Output celebration pulse */
        .output-area.celebrate .output-box {
            animation: celebratePulse 0.5s ease;
        }

        @keyframes celebratePulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(105, 219, 124, 0); }
            50% { box-shadow: 0 0 20px 10px rgba(105, 219, 124, 0.3); }
        }

        /* Commissions Section */
        .commissions-section {
            margin-top: 8px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: var(--space-md);
        }

        .commissions-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border);
        }

        .commissions-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .commissions-date {
            font-size: 12px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .commissions-table-wrapper {
            overflow-x: auto;
            margin: 0 calc(-1 * var(--space-md));
            padding: 0 var(--space-md);
        }

        .commissions-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .commissions-table th {
            text-align: left;
            padding: 10px 12px;
            color: var(--text-muted);
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        .commissions-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            color: var(--text-secondary);
            vertical-align: top;
        }

        .commissions-table tr:last-child td {
            border-bottom: none;
        }

        .commissions-table tr:hover td {
            background: var(--bg-hover);
        }

        .product-name {
            color: var(--text-primary);
            font-weight: 500;
            line-height: 1.4;
            max-width: 300px;
        }

        .product-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            background: var(--accent);
            color: var(--bg-dark);
            font-size: 11px;
            font-weight: 700;
            border-radius: 4px;
            margin-right: 8px;
        }

        .stat-number {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--text-primary);
        }

        .stat-number.zero {
            color: var(--text-muted);
        }

        .stat-number.positive {
            color: var(--success);
        }

        .total-row {
            background: var(--bg-input);
            font-weight: 600;
        }

        .total-row td {
            color: var(--text-primary);
            border-top: 2px solid var(--border);
        }

        .commissions-empty {
            text-align: center;
            padding: var(--space-lg);
            color: var(--text-muted);
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">üé©</span>
                <h1>MagicHat.one</h1>
            </div>
            <div class="total-earned-badge tooltip-bottom" data-tooltip="Check back every sunday when this total is updated to see your weeks purchases.">
                <span class="label">Earned</span>
                <span class="amount">$1.20</span>
            </div>
        </header>

        <!-- Rainbow Bar -->
        <div class="rainbow-bar"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Converter Section -->
            <section class="converter-section">
                <p class="tagline">Feed the family with every Amazon purchase</p>
                
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        id="inputUrl" 
                        class="input-field"
                        placeholder="Paste Amazon link or type what you're looking for..."
                        autocomplete="off"
                        spellcheck="false"
                    >
                </div>

                <button class="convert-btn" id="convertBtn">
                    <span>ü™Ñ</span>
                    Convert to Magic Hat Link
                </button>

                <!-- Error Message -->
                <div class="error-message" id="errorMessage">
                    <div class="error-box"></div>
                </div>

                <!-- Output Area -->
                <div class="output-area" id="outputArea">
                    <div class="output-box">
                        <div class="output-type" id="outputType">
                            <span class="status-dot"></span>
                            <span class="type-text"></span>
                        </div>
                        <div class="output-url" id="outputUrl"></div>
                    </div>
                    <div class="output-actions">
                        <button class="action-btn" id="copyBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                            <span>Copy</span>
                        </button>
                        <button class="action-btn" id="openBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                            </svg>
                            <span>Shop</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tab Section -->
            <section class="tab-section">
                <!-- Tab Bar -->
                <div class="tab-bar">
                    <button class="tab-btn active" data-tab="how-it-works">
                        <span>üìñ</span>
                        <span class="tab-text">How it works</span>
                    </button>
                    <button class="tab-btn" data-tab="faq">
                        <span>‚ùì</span>
                        <span class="tab-text">FAQ</span>
                    </button>
                    <button class="tab-btn" data-tab="share">
                        <span>üì¢</span>
                        <span class="tab-text">Share</span>
                    </button>
                    <button class="tab-btn" data-tab="bookmark">
                        <span>‚≠ê</span>
                        <span class="tab-text">Bookmark</span>
                    </button>
                </div>

                <!-- Tab Panels -->
                <div class="tab-panels">
                    <!-- How It Works Panel -->
                    <div class="tab-panel active" id="how-it-works-panel">
                        <div class="panel-content how-it-works">
                            <p>Turn any amazon purchase into some Magic Hat money! When you shop through the search above, MagicHat.one gets 1-3% commision. You pay the same price ‚Äî but we all get fed. The money goes into Magic Hat during nationals each year.</p>
                            <p>TRANSPARNCY IS KEY - we have nothing to hide, 100% of all all commissions earned follow the breakdown shown below, and anyone who wants to see the account can.</p>
                            <p>NOTE - Using this once before doing your amazon shopping is usually enough to earn MagicHat credit for all your purchases.  You do not need to search each item through MagicHat.one, just once per trip to amazon.</p>
                            <div class="distribution-bar">
                                <div class="distribution-segment magic-hat">80%</div>
                                <div class="distribution-segment dao">15%</div>
                                <div class="distribution-segment server">5%</div>
                            </div>
                            
                            <div class="distribution-legend">
                                <div class="legend-item">
                                    <span class="legend-dot magic-hat"></span>
                                    <span>Magic Hat</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-dot dao"></span>
                                    <span class="tooltip" data-tooltip="Katuah DAO (Decentralized Autonomous Organization) is an experiement. All funds are spent for the family, voted on by the family. If successfull, Katuah DAO will birth other regional DAOs with funding from projects like this.">Katuah DAO</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-dot server"></span>
                                    <span>Server</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ Panel -->
                    <div class="tab-panel" id="faq-panel">
                        <div class="panel-content">
                            <div class="faq-list">
                                <div class="faq-item">
                                    <button class="faq-question">
                                        <span>When will I see how much I earned?</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </button>
                                    <div class="faq-answer">
                                        <p>We're working on automating the process but for now we update earnings once weekly. It takes a few days for Amazon to report earnings, but select family will have full account access for verification.  Check back soon!  The homepage should be showing recent commissions by mid Feb</p>
                                    </div>
                                </div>

                                <div class="faq-item">
                                    <button class="faq-question">
                                        <span>Who runs this?</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </button>
                                    <div class="faq-answer">
                                        <p>I do (https://www.facebook.com/mikeosborne42/)</p>
                                    </div>
                                </div>

                                <div class="faq-item">
                                    <button class="faq-question">
                                        <span>When does Magic Hat get the money?</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </button>
                                    <div class="faq-answer">
                                        <p>During the first week of Nationals each year, our team contributes the year's earnings directly to Magic Hat at the gathering.  Once the 501(3)(c) is formed, we may distribute funds to kitchens etc before nationals begins.</p>
                                    </div>
                                </div>

                                <div class="faq-item">
                                    <button class="faq-question">
                                        <span>What are the long-term plans?</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </button>
                                    <div class="faq-answer">
                                        <p>Continue deleloping projects like that benefit rainbow.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Share Panel -->
                    <div class="tab-panel" id="share-panel">
                        <div class="panel-content share-panel">
                            <p>Every person who uses this puts dollars directly into Magic Hat. Spread the word!</p>
                            
                            <div class="share-buttons">
                                <a href="https://www.facebook.com/sharer/sharer.php?u=https://magichatlink.com&quote=Support%20the%20Rainbow%20Family%20Magic%20Hat%20with%20every%20Amazon%20purchase%20%E2%80%94%20at%20no%20extra%20cost%20to%20you!%20%F0%9F%8C%88" target="_blank" rel="noopener noreferrer" class="share-btn facebook">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                    </svg>
                                    <span class="btn-text">Facebook</span>
                                </a>
                                <a href="https://twitter.com/intent/tweet?text=Support%20the%20Rainbow%20Family%20Magic%20Hat%20with%20every%20Amazon%20purchase%20%E2%80%94%20at%20no%20extra%20cost%20to%20you!%20%F0%9F%8C%88&url=https://magichatlink.com" target="_blank" rel="noopener noreferrer" class="share-btn twitter">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                                    </svg>
                                    <span class="btn-text">X</span>
                                </a>
                                <a href="https://www.reddit.com/submit?url=https://magichatlink.com&title=Support%20Rainbow%20Family%20Magic%20Hat%20with%20Amazon%20purchases" target="_blank" rel="noopener noreferrer" class="share-btn reddit">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                                    </svg>
                                    <span class="btn-text">Reddit</span>
                                </a>
                                <a href="mailto:?subject=Support%20Rainbow%20Family%20Magic%20Hat&body=Check%20out%20this%20site%20that%20supports%20the%20Rainbow%20Family%20Magic%20Hat%20with%20every%20Amazon%20purchase%20%E2%80%94%20at%20no%20extra%20cost!%0A%0Ahttps://magichatlink.com" class="share-btn email">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                                    </svg>
                                    <span class="btn-text">Email</span>
                                </a>
                                <button class="share-btn copy" id="shareCopyBtn">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                                    </svg>
                                    <span class="btn-text">Copy</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Bookmark Panel -->
                    <div class="tab-panel" id="bookmark-panel">
                        <div class="panel-content bookmark-panel">
                            <div class="bookmark-icon-large">‚≠ê</div>
                            <h3>Bookmark This Page</h3>
                            <p>Come back here every time you shop to support Magic Hat!</p>
                            
                            <div class="keyboard-shortcuts">
                                <div class="shortcut">
                                    <span class="shortcut-key">Ctrl+D</span>
                                    <span class="shortcut-label">Windows</span>
                                </div>
                                <div class="shortcut">
                                    <span class="shortcut-key">‚åò+D</span>
                                    <span class="shortcut-label">Mac</span>
                                </div>
                            </div>
                            
                            <p style="font-size: 12px; color: var(--text-muted);">Mobile: Tap share button ‚Üí Add to Bookmarks</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Recent Commissions Section -->
        <section class="commissions-section" id="commissionsSection">
            <div class="commissions-header">
                <div class="commissions-title">
                    <span>üìä</span>
                    Recent Commissions
                </div>
                <div class="commissions-date" id="commissionsDate">Updated weekly</div>
            </div>
            <div class="commissions-table-wrapper">
                <table class="commissions-table" id="commissionsTable">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th style="text-align: center;">Total Earned</th>
                        </tr>
                    </thead>
                    <tbody id="commissionsBody">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p class="footer-text">
                As an Amazon Associate, we (Magic Hat) earn from qualifying purchases.<br>
                üåà We love you.
            </p>
            <div class="rainbow-bar-bottom"></div>
        </footer>
    </div>

    <!-- Success Flash -->
    <div class="success-flash" id="successFlash">üéâ</div>

    <!-- Confetti Container -->
    <div class="confetti-container" id="confettiContainer"></div>

    <script>
        // Configuration
        const AFFILIATE_TAG = 'magichatone-20';

        const TRACKING_PARAMS = [
            'ref', 'ref_', 'pf_rd_p', 'pf_rd_r', 'pf_rd_s', 'pf_rd_t', 'pf_rd_i',
            'pd_rd_i', 'pd_rd_r', 'pd_rd_w', 'pd_rd_wg', 'psc', 'qid', 'sr',
            'dchild', 'keywords', 'crid', 'sprefix', 'spLa', 'smid', 'linkCode',
            'linkId', 'camp', 'creative', 'creativeASIN', 'tag', 'ascsubtag',
            'th', 'ie', 'encoding', 'pd_rd_p', 'content-id', 'cv_ct_cx',
            '_encoding', 'rnid', 'rps', 'dib', 'dib_tag'
        ];

        const ASIN_PATTERNS = [
            /\/dp\/([A-Z0-9]{10})/i,
            /\/gp\/product\/([A-Z0-9]{10})/i,
            /\/gp\/aw\/d\/([A-Z0-9]{10})/i,
            /\/exec\/obidos\/asin\/([A-Z0-9]{10})/i,
            /\/o\/ASIN\/([A-Z0-9]{10})/i,
            /\/product\/([A-Z0-9]{10})/i,
        ];

        // DOM Elements
        const inputEl = document.getElementById('inputUrl');
        const convertBtn = document.getElementById('convertBtn');
        const outputArea = document.getElementById('outputArea');
        const outputUrl = document.getElementById('outputUrl');
        const outputType = document.getElementById('outputType');
        const copyBtn = document.getElementById('copyBtn');
        const openBtn = document.getElementById('openBtn');
        const errorMessage = document.getElementById('errorMessage');
        const successFlash = document.getElementById('successFlash');
        const confettiContainer = document.getElementById('confettiContainer');

        let currentAffiliateUrl = '';

        // URL Processing Functions
        function extractASIN(url) {
            for (const pattern of ASIN_PATTERNS) {
                const match = url.match(pattern);
                if (match) return match[1].toUpperCase();
            }
            return null;
        }

        function normalizeAmazonDomain(url) {
            return url
                .replace(/^(https?:\/\/)?(smile\.|m\.)?amazon\.com/, 'https://www.amazon.com')
                .replace(/^(https?:\/\/)?(smile\.|m\.)?amazon\.(co\.uk|de|fr|es|it|ca|com\.au|co\.jp|in|com\.mx|com\.br|nl|se|pl|sg|ae|sa|eg|tr)/, 'https://www.amazon.com');
        }

        function stripTrackingParams(url) {
            try {
                const urlObj = new URL(url);
                TRACKING_PARAMS.forEach(param => {
                    urlObj.searchParams.delete(param);
                    for (let i = 0; i < 10; i++) {
                        urlObj.searchParams.delete(param + i);
                    }
                });
                return urlObj;
            } catch {
                return null;
            }
        }

        function isLikelyUrl(input) {
            const urlPatterns = [
                /^https?:\/\//i,
                /^www\./i,
                /amazon\./i,
                /amzn\./i,
                /\.com/i,
                /\.co\./i,
                /\/dp\//i,
                /\/gp\//i
            ];
            return urlPatterns.some(pattern => pattern.test(input));
        }

        function createSearchUrl(searchTerm) {
            const encodedSearch = encodeURIComponent(searchTerm.trim());
            return {
                url: 'https://www.amazon.com/s?k=' + encodedSearch + '&tag=' + AFFILIATE_TAG,
                type: 'search',
                searchTerm: searchTerm.trim()
            };
        }

        function convertUrl(inputUrl) {
            let input = inputUrl.trim();
            
            if (!input) {
                throw new Error('Please enter a product name or paste an Amazon link');
            }

            // Check if it looks like a URL or a search term
            if (!isLikelyUrl(input)) {
                return createSearchUrl(input);
            }

            let url = input;

            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }

            if (!url.includes('amazon.')) {
                throw new Error('That doesn\'t look like an Amazon link');
            }

            if (url.includes('amzn.to') || url.includes('amzn.com')) {
                throw new Error('Short links (amzn.to) aren\'t supported ‚Äî use the full Amazon URL');
            }

            url = normalizeAmazonDomain(url);
            const asin = extractASIN(url);

            if (asin) {
                return {
                    url: 'https://www.amazon.com/dp/' + asin + '?tag=' + AFFILIATE_TAG,
                    type: 'clean',
                    asin: asin
                };
            } else {
                const urlObj = stripTrackingParams(url);
                if (!urlObj) {
                    throw new Error('Couldn\'t parse that URL');
                }
                urlObj.searchParams.set('tag', AFFILIATE_TAG);
                return {
                    url: urlObj.toString(),
                    type: 'fallback',
                    asin: null
                };
            }
        }

        // UI Functions
        function showError(message) {
            const errorBox = errorMessage.querySelector('.error-box');
            errorBox.textContent = message;
            errorMessage.classList.add('visible');
            outputArea.classList.remove('visible');
        }

        function hideError() {
            errorMessage.classList.remove('visible');
        }

        function showOutput(result) {
            currentAffiliateUrl = result.url;
            outputUrl.textContent = result.url;
            
            const typeText = outputType.querySelector('.type-text');
            
            if (result.type === 'clean') {
                typeText.textContent = 'Clean link ready';
                outputType.className = 'output-type clean';
            } else if (result.type === 'search') {
                typeText.textContent = 'Search link ready for "' + result.searchTerm + '"';
                outputType.className = 'output-type search';
            } else {
                typeText.textContent = 'Link ready (search/category page)';
                outputType.className = 'output-type fallback';
            }
            
            outputArea.classList.add('visible');
            hideError();
            
            copyBtn.classList.remove('copied');
            copyBtn.querySelector('span').textContent = 'Copy';
            
            celebrateSuccess();
        }

        // Celebration Animation
        const colors = ['#ff6b6b', '#ffa94d', '#ffd43b', '#69db7c', '#74c0fc', '#9775fa', '#da77f2'];

        function createConfetti() {
            confettiContainer.innerHTML = '';
            confettiContainer.classList.add('active');
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.width = (Math.random() * 8 + 6) + 'px';
                confetti.style.height = (Math.random() * 8 + 6) + 'px';
                
                const duration = Math.random() * 2 + 1;
                const delay = Math.random() * 0.5;
                const drift = (Math.random() - 0.5) * 200;
                
                confetti.animate([
                    { opacity: 1, transform: 'translateY(0) translateX(0) rotate(0deg)' },
                    { opacity: 1, transform: 'translateY(' + window.innerHeight + 'px) translateX(' + drift + 'px) rotate(' + (Math.random() * 720) + 'deg)' },
                    { opacity: 0, transform: 'translateY(' + (window.innerHeight + 100) + 'px) translateX(' + drift + 'px) rotate(' + (Math.random() * 720) + 'deg)' }
                ], {
                    duration: duration * 1000,
                    delay: delay * 1000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                confettiContainer.appendChild(confetti);
            }
            
            setTimeout(function() {
                confettiContainer.classList.remove('active');
            }, 3500);
        }

        function celebrateSuccess() {
            successFlash.classList.add('animate');
            setTimeout(function() {
                successFlash.classList.remove('animate');
            }, 600);
            
            createConfetti();
            
            outputArea.classList.add('celebrate');
            setTimeout(function() {
                outputArea.classList.remove('celebrate');
            }, 500);
        }

        // Event Listeners
        convertBtn.addEventListener('click', function() {
            try {
                const result = convertUrl(inputEl.value);
                showOutput(result);
                // Auto-open search results in new tab
                if (result.type === 'search') {
                    const newWindow = window.open(result.url, '_blank');
                    if (newWindow) newWindow.opener = null;
                }
            } catch (err) {
                showError(err.message);
            }
        });

        inputEl.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                convertBtn.click();
            }
        });

        inputEl.addEventListener('paste', function() {
            setTimeout(function() { convertBtn.click(); }, 50);
        });

        copyBtn.addEventListener('click', async function() {
            try {
                await navigator.clipboard.writeText(currentAffiliateUrl);
                copyBtn.classList.add('copied');
                copyBtn.querySelector('span').textContent = 'Copied!';
                setTimeout(function() {
                    copyBtn.classList.remove('copied');
                    copyBtn.querySelector('span').textContent = 'Copy';
                }, 2000);
            } catch (e) {
                const textarea = document.createElement('textarea');
                textarea.value = currentAffiliateUrl;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                copyBtn.classList.add('copied');
                copyBtn.querySelector('span').textContent = 'Copied!';
                setTimeout(function() {
                    copyBtn.classList.remove('copied');
                    copyBtn.querySelector('span').textContent = 'Copy';
                }, 2000);
            }
        });

        openBtn.addEventListener('click', function() {
            const newWindow = window.open(currentAffiliateUrl, '_blank');
            if (newWindow) newWindow.opener = null;
        });

        // Tab Functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabPanels = document.querySelectorAll('.tab-panel');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // Update active states
                tabBtns.forEach(b => b.classList.remove('active'));
                tabPanels.forEach(p => p.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(tabId + '-panel').classList.add('active');
            });
        });

        // FAQ Accordion
        const faqItems = document.querySelectorAll('.faq-item');

        faqItems.forEach(item => {
            const question = item.querySelector('.faq-question');
            question.addEventListener('click', function() {
                const isActive = item.classList.contains('active');
                
                // Close all other items
                faqItems.forEach(i => i.classList.remove('active'));
                
                // Toggle current item
                if (!isActive) {
                    item.classList.add('active');
                }
            });
        });

        // Share Copy Button
        const shareCopyBtn = document.getElementById('shareCopyBtn');
        if (shareCopyBtn) {
            shareCopyBtn.addEventListener('click', async function() {
                const pageUrl = window.location.href;
                try {
                    await navigator.clipboard.writeText(pageUrl);
                    shareCopyBtn.classList.add('copied');
                    shareCopyBtn.querySelector('.btn-text').textContent = 'Copied!';
                    setTimeout(function() {
                        shareCopyBtn.classList.remove('copied');
                        shareCopyBtn.querySelector('.btn-text').textContent = 'Copy';
                    }, 2000);
                } catch (e) {
                    const textarea = document.createElement('textarea');
                    textarea.value = pageUrl;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    shareCopyBtn.classList.add('copied');
                    shareCopyBtn.querySelector('.btn-text').textContent = 'Copied!';
                    setTimeout(function() {
                        shareCopyBtn.classList.remove('copied');
                        shareCopyBtn.querySelector('.btn-text').textContent = 'Copy';
                    }, 2000);
                }
            });
        }

        // Commissions Data - Easy to update by pasting raw data
        // Format: Product Name | Total Earned
        const COMMISSIONS_DATA = `
iKKEGOL Mini 2-Port RJ45 Network Key-Press Switch Splitter Selector Box 100M 2-in 1-Out or 1-in 2-Out	$0.00
Moxita 10ft - 1/2 inch Cord Protector Cable Sleeve Split Wire Loom Tubing for Power Cord Audio USB Cable, Cord Sleeve Cable Management for TV Computer	$0.00
RJ45 Coupler, Ethernet Network Cable in line Coupler for Cat7/Cat6/Cat5e/Cat5, Ethernet Network Cable Extender Female to Female (4 Pcs)	$0.00
`;

        // Parse and display commissions
        function parseCommissionsData(rawData) {
            const lines = rawData.trim().split('\n');
            if (lines.length < 1) return [];

            const products = [];
            let currentProduct = null;

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const parts = line.split('\t');

                if (parts.length >= 2) {
                    // Save previous product if exists
                    if (currentProduct) {
                        products.push(currentProduct);
                    }

                    // New product with name and earnings
                    currentProduct = {
                        name: parts[0].trim(),
                        earned: parts[1].trim()
                    };
                } else if (currentProduct && parts.length === 1) {
                    // This is a continuation of the product name
                    currentProduct.name += ' ' + parts[0];
                }
            }

            if (currentProduct) {
                products.push(currentProduct);
            }

            return products;
        }

        function renderCommissions() {
            const tbody = document.getElementById('commissionsBody');
            const products = parseCommissionsData(COMMISSIONS_DATA);

            if (products.length === 0) {
                tbody.innerHTML = '<tr><td colspan="2" class="commissions-empty">No commissions data available yet. Check back soon!</td></tr>';
                return;
            }

            let totalEarned = 0;

            tbody.innerHTML = products.map(product => {
                // Parse earnings (remove $ and convert to number)
                const earnedValue = parseFloat(product.earned.replace('$', '').replace(',', '')) || 0;
                totalEarned += earnedValue;

                const isZero = earnedValue === 0;

                return `
                    <tr>
                        <td>
                            <span class="product-name">${escapeHtml(product.name)}</span>
                        </td>
                        <td style="text-align: center;"><span class="stat-number ${isZero ? 'zero' : 'positive'}">${product.earned}</span></td>
                    </tr>
                `;
            }).join('') + `
                <tr class="total-row">
                    <td>TOTAL</td>
                    <td style="text-align: center;"><span class="stat-number ${totalEarned === 0 ? 'zero' : 'positive'}">$${totalEarned.toFixed(2)}</span></td>
                </tr>
            `;

            // Update the date
            const dateElement = document.getElementById('commissionsDate');
            const now = new Date();
            dateElement.textContent = 'Updated: ' + now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize commissions table on load
        renderCommissions();
    </script>
</body>
</html>
